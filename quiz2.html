<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í† ìŠ¤ ê²Œì„ - í…Œë‘ë¦¬ ê°•ì¡°í˜•</title>
    <style>
        body { 
            font-family: 'Pretendard', -apple-system, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
            background: #f5f7fa; 
            color: #333; 
            overflow: hidden; 
        }

        .card { 
            background: white; 
            padding: 30px 25px; 
            border-radius: 30px; 
            text-align: center; 
            width: 440px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
        }

        #level-info { 
            color: #1a73e8; 
            font-weight: bold; 
            font-size: 1.4rem; 
            margin-bottom: 10px; 
        }

        #timer-container { 
            width: 100%; 
            background: #e8f0fe; 
            height: 10px; 
            border-radius: 10px; 
            margin: 20px 0; 
            overflow: hidden; 
        }

        #timer-bar { 
            width: 100%; 
            height: 100%; 
            background: #1a73e8; 
            transition: linear; 
        }

        .grid { 
            display: grid; 
            gap: 8px; 
            margin-top: 25px; 
        }

        .grid button { 
            aspect-ratio: 1; 
            border: 2px solid #e8f0fe; /* ê¸°ë³¸ í…Œë‘ë¦¬ */
            border-radius: 12px; 
            background: #ffffff; 
            color: #1a73e8; 
            font-size: 1.1rem; 
            font-weight: bold; 
            cursor: pointer; 
            padding: 0; 
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.03);
        }

        /* [í•µì‹¬] í…Œë‘ë¦¬ë§Œ ìƒ‰ìƒ ë³€ê²½í•˜ëŠ” ìŠ¤íƒ€ì¼ */
        .grid button.correct-ans {
            background-color: #ffffff !important; /* ë°°ê²½ì€ í°ìƒ‰ ìœ ì§€ */
            color: #4CAF50 !important;           /* ê¸€ììƒ‰ ì´ˆë¡ */
            border: 3px solid #4CAF50 !important; /* í…Œë‘ë¦¬ ì´ˆë¡ + ë‘ê»ê²Œ */
        }

        .grid button.wrong-ans {
            background-color: #ffffff !important; /* ë°°ê²½ì€ í°ìƒ‰ ìœ ì§€ */
            color: #F44336 !important;           /* ê¸€ììƒ‰ ë¹¨ê°• */
            border: 3px solid #F44336 !important; /* í…Œë‘ë¦¬ ë¹¨ê°• + ë‘ê»ê²Œ */
        }

        .grid button:disabled { cursor: default; }

        .instruction {
            font-size: 1rem;
            color: #666;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

<div class="card">
    <div id="level-info">Level 1</div>
    <div id="timer-container"><div id="timer-bar"></div></div>
    <div class="instruction">ë‹¤ë¥¸ ê¸€ìë¥¼ ì°¾ìœ¼ì„¸ìš”!</div>
    <div class="grid" id="game-grid"></div>
</div>

<script>
    const stages = [
        { size: 2, normal: "SALC", diff: "SAIC", time: 4300 },
        { size: 3, normal: "SALC", diff: "SAIC", time: 4300 },
        { size: 4, normal: "SALC", diff: "SAIC", time: 4300 },
        { size: 5, normal: "SALC", diff: "SAIC", time: 4300 },
        { size: 6, normal: "SALC", diff: "SAIC", time: 4300 }
    ];

    let currentLevel = 0;
    let timerId = null;
    let isGameOver = false;

    function initGame() {
        if (currentLevel >= stages.length) {
            alert("ğŸŠ ë¯¸ì…˜ í´ë¦¬ì–´! ëŒ€ë‹¨í•œ ì§‘ì¤‘ë ¥ì…ë‹ˆë‹¤.");
            window.location.href = 'index.html';
            return;
        }

        isGameOver = false;
        const stage = stages[currentLevel];
        const gridSize = stage.size;
        const totalCells = gridSize * gridSize;

        document.getElementById('level-info').innerText = `Level ${currentLevel + 1} (${gridSize}x${gridSize})`;
        
        const grid = document.getElementById('game-grid');
        grid.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
        grid.innerHTML = "";

        const diffIndex = Math.floor(Math.random() * totalCells);

        for (let i = 0; i < totalCells; i++) {
            const btn = document.createElement('button');
            if (gridSize === 5) btn.style.fontSize = "0.9rem";
            if (gridSize >= 6) btn.style.fontSize = "0.8rem";
            
            btn.innerText = (i === diffIndex) ? stage.diff : stage.normal;
            btn.onclick = (e) => handleButtonClick(i === diffIndex, e.target, diffIndex);
            grid.appendChild(btn);
        }
        startTimer(stage.time, diffIndex);
    }

    function handleButtonClick(isCorrect, targetBtn, correctIdx) {
        if (isGameOver) return;
        isGameOver = true; 
        clearTimeout(timerId); 

        const allBtns = document.querySelectorAll('.grid button');
        allBtns.forEach(btn => btn.disabled = true);

        const bar = document.getElementById('timer-bar');
        const computedStyle = window.getComputedStyle(bar);
        const currentWidth = computedStyle.getPropertyValue('width');
        bar.style.transition = 'none';
        bar.style.width = currentWidth;

        if (isCorrect) {
            targetBtn.classList.add('correct-ans');
            setTimeout(() => {
                currentLevel++;
                initGame();
            }, 700);
        } else {
            targetBtn.classList.add('wrong-ans');
            allBtns[correctIdx].classList.add('correct-ans');
            setTimeout(() => {
                alert("âŒ ì•„ì‰½ë„¤ìš”! ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”.");
                location.reload();
            }, 1000);
        }
    }

    function startTimer(duration, correctIdx) {
        const bar = document.getElementById('timer-bar');
        bar.style.transition = 'none';
        bar.style.width = '100%';
        bar.offsetHeight; 
        bar.style.transition = `width ${duration}ms linear`;
        bar.style.width = '0%';

        if (timerId) clearTimeout(timerId);
        
        timerId = setTimeout(() => {
            if (isGameOver) return; 
            isGameOver = true;
            const allBtns = document.querySelectorAll('.grid button');
            allBtns.forEach(btn => btn.disabled = true);
            allBtns[correctIdx].classList.add('correct-ans');

            setTimeout(() => {
                alert("â° ì‹œê°„ ì´ˆê³¼! ì¡°ê¸ˆ ë” ë¹¨ë¦¬ ì°¾ì•„ë³´ì„¸ìš”.");
                location.reload();
            }, 1000);
        }, duration);
    }

    initGame();
</script>

</body>
</html>
